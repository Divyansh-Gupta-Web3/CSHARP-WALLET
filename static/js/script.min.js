const dark = "/static/images/icon/icon-algo-exp-dark.png",
  light = "/static/images/icon/icon-algo-exp.png",
  night = "/static/images/icon/night-mode.png",
  brightness = "/static/images/icon/brightness.png";
var flag = null,
  i = null;
function mediaQ() {
  if (window.matchMedia("(max-width: 1023px)").matches) return !0;
}
function chatSearch(e, t) {
  var s = $(e).val().toLowerCase();
  $(t + " > li > div").each(function () {
    $(this).toggle($(this).text().toLowerCase().indexOf(s) > -1);
  });
}
function NftDetails() {
  $("#show-more").toggle(),
    $("#show-less").toggle(),
    $("#show-toggle-btn").toggle();
}
function SelectData() {
  $("#show-data").toggle(),
    $("#show-less").toggle(),
    $("#show-toggle-btn").toggle();
}
function NewPassword() {
  var e = $("#Pwd");
  "password" === e.attr("type")
    ? (e.attr("type", "text"),
      $(".bi-eye-slash-fill").css("display", "none"),
      $(".bi-eye-fill").css("display", "block"))
    : (e.attr("type", "password"),
      $(".bi-eye-fill").css("display", "none"),
      $(".bi-eye-slash-fill").css("display", "block"));
}
function ConfirmPassword() {
  var e = $("#con-pwd");
  "password" === e.attr("type")
    ? (e.attr("type", "text"),
      $(".bi-eye-slash-fill-2").css("display", "none"),
      $(".bi-eye-fill-2").css("display", "block"))
    : (e.attr("type", "password"),
      $(".bi-eye-fill-2").css("display", "none"),
      $(".bi-eye-slash-fill-2").css("display", "block"));
}
function matchPassword() {
  var e = $("#Pwd"),
    t = e.val(),
    s = $("#con-pwd"),
    a = s.val();
  "" != a
    ? a === t
      ? (s.css("border", "3px solid rgb(98,179,97)"),
        e.css("border", "3px solid rgb(98,179,97)"))
      : (s.css("border", "3px solid red"), e.css("border", "3px solid red"))
    : "" === a &&
      "" === t &&
      (s.css("border", "2px solid white"), e.css("border", "2px solid white"));
}
function SignUpPassword() {
  var e = $("#signup-pwd");
  "password" === e.attr("type")
    ? (e.attr("type", "text"),
      $(".bi-eye-slash-fill").css("display", "none"),
      $(".bi-eye-fill").css("display", "block"))
    : (e.attr("type", "password"),
      $(".bi-eye-fill").css("display", "none"),
      $(".bi-eye-slash-fill").css("display", "block"));
}
function loginPassword() {
    var e = $("#login-pwd");
    "password" === e.attr("type")
        ? (e.attr("type", "text"),
            $(".bi-eye-slash-fill").css("display", "none"),
            $(".bi-eye-fill").css("display", "block"))  
        : (e.attr("type", "password"),
            $(".bi-eye-fill").css("display", "none"),
            $(".bi-eye-slash-fill").css("display", "block"));   
}


//   var e = $("#login-pwd");
//   e.hasClass("disc-text")
//     ? (e.removeClass("disc-text"),
//       $(".bi-eye-slash-fill").css("display", "none"),
//       $(".bi-eye-fill").css("display", "block"))
//     : (e.addClass("disc-text"),
//       $(".bi-eye-fill").css("display", "none"),
//       $(".bi-eye-slash-fill").css("display", "block"));

function chatBoxes() {
  mediaQ()
    ? (localStorage.setItem("chat_open", "block"),
      localStorage.setItem("chat_list", "none"))
    : (localStorage.setItem("chat_open", "block"),
      localStorage.setItem("chat_list", "block"));
}
function tooltip() {
  var e = $("#tooltip-text");
  "block" == e.css("display")
    ? e.css("display", "none")
    : e.css("display", "block");
}
function scroll() {
  var e = 0;
  $("#open-msg").each(function () {
    e += parseInt($(this).height());
  }),
    (e += ""),
    $("#open-msg").animate({ scrollTop: e });
}
function balance(e) {
  $("#main-balance").html(e.options[e.selectedIndex].id);
}
function theme() {
  "1" === localStorage.getItem("namespace.visited")
    ? ($("body").addClass("dark-mode"),
      $("#dark-toggle").attr("src", night),
      (flag = 1))
    : ($("#dark-toggle").attr("src", brightness), (flag = 0));
  var e = $(".algo-icon");
  for (i = 0; i < e.length; i++)
    1 === flag ? (e[i].src = dark) : (e[i].src = light);
  localStorage.hasOwnProperty("lastOpen") ||
    localStorage.setItem("lastOpen", changeDateFormat(new Date(2022, 5, 1))),
    countNotification();
}
function dropdown(e) {
  "message" === e.id
    ? "block" == $("#dropdown-menu-chat").css("display")
      ? $("#dropdown-menu-chat").css("display", "none")
      : ($("#dropdown-menu-chat").css("display", "block"),
        $("#dropdown-menu-notification").css("display", "none"))
    : "block" == $("#dropdown-menu-notification").css("display")
    ? $("#dropdown-menu-notification").css("display", "none")
    : ($("#dropdown-menu-notification").css("display", "block"),
      $("#dropdown-menu-chat").css("display", "none"));
}
function navbar() {
  $(".main-navbar").toggleClass("show"), $(".mobile-icon").toggleClass("open");
}
function darkMode() {
  $("body").hasClass("dark-mode")
    ? ($("body").removeClass("dark-mode"),
      $("#dark-toggle").attr("src", brightness),
      localStorage.removeItem("namespace.visited"),
      (flag = 1))
    : (localStorage.setItem("namespace.visited", 1),
      $("body").addClass("dark-mode"),
      $("#dark-toggle").attr("src", night),
      (flag = 0));
  var e = $(".algo-icon");
  for (i = 0; i < e.length; i++)
    1 === flag ? (e[i].src = light) : (e[i].src = dark);
}
function checkLength(e) {
  e.value.length > 7
    ? ((e.value = e.value.substring(0, 7)), $(".max-char-text").show())
    : $(".max-char-text").hide();
}
function checkPassword() {
  $("#current-pass").val().length > 0 &&
    $("#Pwd").val().length > 0 &&
    ($("#current-pass").val() === $("#Pwd").val()
      ? (alertify.set("notifier", "position", "bottom-right"),
        alertify.notify("New Password Cannot Be Same As Current Password."),
        $("#profile-update").prop("type", "button"))
      : $("#profile-update").prop("type", "submit"));
}
function address(e) {
  var t = e.id;
  navigator.clipboard.writeText(t),
    alertify.set("notifier", "position", "bottom-right"),
    alertify.notify("Account Address Copied");
}
function sendAddress(e) {
  $("#address").val(e.id),
    $("#address").prop("readonly", "readonly"),
    $("#address").addClass("disable-bg");
}
function clearAddress() {
  $("#amount").val(""),
    $("#address").val(""),
    $("#send-pwd").val(""),
    $("#address").removeAttr("readonly"),
    $("#address").removeClass("disable-bg");
}
function validateSize(e) {
  let t = e.files[0].size / 1024 / 1024;
  if (!/(\.png)$/i.exec(e.value))
    return alertify.notify("Only PNG Files Are Allowed."), (e.value = ""), !1;
  if (t > 0.3 || t < 0.03)
    alertify.notify("Please Choose An Image Size Between 30 KB And 300 KB"),
      $(e).val("");
  else {
    var s = e.value,
      a = s.substring(s.lastIndexOf(".") + 1).toLowerCase();
    if (
      e.files &&
      e.files[0] &&
      ("gif" === a || "png" === a || "jpeg" === a || "jpg" === a)
    ) {
      var n = new FileReader();
      (n.onload = function (e) {
        $("#user-img-data").attr("src", e.target.result);
      }),
        n.readAsDataURL(e.files[0]);
    } else
      alertify.notify("Unsupported File Type."),
        $("#user-img-data").attr("src", "/static/images/noimg.png"),
        $("#fav-img-data").val("");
  }
}
function add(e) {
  if (e && 0 !== e) {
    if (e.includes(".")) {
      if (e % 1 != 0) {
        let t = e.toString().split(".")[1].length;
        switch (t) {
          case 1:
            e += "00";
            break;
          case 2:
            e += "0";
        }
      }
    } else e += ".000";
  }
  return e;
}
function moneyFormat(e) {
  e &&
    (e < 0.001
      ? ($("#send-btn").attr("disabled", "disabled"),
        $("#send-btn").css("background-color", "#afacac"),
        alertify.notify("You Can Send/Request Minimum Of 0.001 MPayz"))
      : e > 1e5
      ? ($("#send-btn").attr("disabled", "disabled"),
        $("#send-btn").css("background-color", "#afacac"),
        alertify.notify("You Can Send/Request Maximum Of 100000 MPayz"))
      : ($("#send-btn").removeAttr("disabled"),
        $("body").hasClass("dark-mode")
          ? $("#send-btn").css("background-color", "#363434")
          : $("#send-btn").css("background-color", "#62B361")));
}
function countNotification() {
  var e = document.getElementById("user-name").innerHTML;
  if (void 0 != e) {
    var t = 0;
    fetch("/static/user_json/" + e + ".json")
      .then((e) => e.json())
      .then((e) => {
        var s = JSON.stringify(localStorage.getItem("lastOpen"));
        s = s.slice(1, -1);
        for (var a = 0; a < e.length; a++)
          if ("string" == typeof e[a].date) {
            var n = changeDateFormat(new Date(e[a].date));
            new Date(n) > new Date(s) && t++;
          }
      })
      .catch((e) => {
        console.log(e);
      })
      .then(() => {
        t > 0 && document.getElementById("count-notification").innerHTML;
      });
  }
}
function changeDateFormat(e) {
  t = 10 > e.getDate() ? "0" + e.getDate() : e.getDate();
  var t,
    s = e.toLocaleString("en-us", { month: "short" }),
    a = e.getFullYear(),
    n = e.getHours(),
    o = e.getMinutes();
  return s + " " + t + ", " + a + ", " + n + ":" + (o = o < 10 ? "0" + o : o);
}
function storeDate() {
  var e = new Date();
  (x = changeDateFormat(e)),
    console.log(x),
    localStorage.setItem("lastOpen", x);
}
function getPass() {
  swal(
    "Attention!",
    "Your passphrase will display on the next page. Use caution when viewing in public spaces. Save and guard the entire 25-word passphrase to prevent unauthorized access to your account. Account recovery will require all passphrase words.",
    "warning",
    { button: "Confirm " }
  ).then(function () {
    window.location = "/getpass";
  });
}
function logout() {
  alertify.confirm("Movable: false").set("movable", !1),
    alertify.confirm(
      "Wait...",
      "Are you sure you want to logout?",
      function () {
        window.location = "/logoutpage";
      },
      function () {}
    );
}
function settings() {
  window.location = "/settings";
}
function netToggle() {
  swal("OOPS!", "This feature is currently under development.", "info", {
    button: "OK",
  });
}
function inbox() {
  mediaQ() &&
    (localStorage.setItem("chat_open", "none"),
    localStorage.setItem("chat_list", "block")),
    window.open("/messages", "_self");
}
function txnDetails(e) {
  var t = $("#sessionName").html().trim(),
    s = "";
  "testnet" === t && (s = "testnet.");
  var a = e.id;
  window.open("https://" + s + "algoexplorer.io/tx/" + a, "_blank");
}
function buy() {
  window.open("https://www.moonpay.com/buy", "_blank");
}
function upload() {
  $("#user-img").click();
}
function read(e) {
  var t = e.value,
    s = t.substring(t.lastIndexOf(".") + 1).toLowerCase();
  if (
    e.files &&
    e.files[0] &&
    ("gif" === s || "png" === s || "jpeg" === s || "jpg" === s)
  ) {
    var a = new FileReader();
    (a.onload = function (e) {
      $("#user-img-data").attr("src", e.target.result);
    }),
      a.readAsDataURL(e.files[0]);
  } else $("#user-img-data").attr("src", "/static/images/noimg.png");
}
$(window).on("load", function () {
  var e;
  mediaQ()
    ? ((chat_open = "none"), (e = "block"))
    : ((chat_open = "block"), (e = "block")),
    localStorage.hasOwnProperty("chat_open") ||
      localStorage.setItem("chat_open", chat_open),
    localStorage.hasOwnProperty("chat_list") ||
      localStorage.setItem("chat_list", e),
    $("#chat-open").css("display", localStorage.getItem("chat_open")),
    $("#chat-list").css("display", localStorage.getItem("chat_list"));
}),
  $(document).ready(function () {
    theme(),
      $("#chat-search").on("keyup", function () {
        chatSearch(this, "#chat-list");
      }),
      $("#msg-input").on("keypress", function (e) {
        if (13 === (e.keyCode || e.which))
          return (
            alertify.set("notifier", "position", "top-center"),
            alertify.notify("Click On SEND Button To Send Message."),
            e.preventDefault(),
            !1
          );
      }),
      $("#chat-btn").on("click", function (e) {
        $("#chat-btn").css("pointer-events", "none"),
          $("#chat-btn").css("background-color", "#afacac");
      }),
      $(".amount").focusout(function () {
        var e = $(this).val();
        $(this).val(add(e)), moneyFormat(add(e));
      }),
      $("#open-msg").scrollTop($("#open-msg")[0].scrollHeight);
  });
